<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Speech Synthesis</title>
    <style>
        textarea {
            display: block;
            margin-top: 8px;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
<form>
    <select name="lang"></select>
    <select name="name"></select>
    <textarea name="text" placeholder="Text" id="text" cols="100" rows="10"></textarea>
    <button id="speak" type="button">Speak</button>
</form>
<script>
    var s_lang = document.querySelector('[name="lang"]');
    var s_name = document.querySelector('[name="name"]');
    speechSynthesis.addEventListener('voiceschanged', function () {
        var voices = speechSynthesis.getVoices();
        voices.sort(function (a, b) {
            return a.lang.localeCompare(b.lang) || a.name.localeCompare(b.name);
        });
        var voice = voices[0];

        voices.forEach(function (voice) {
            let option = s_lang.querySelector(`[value="${voice.lang}"]`);
            if (!option) {
                option = document.createElement('option');
                option.value = voice.lang;
                option.innerHTML = voice.lang;
                s_lang.appendChild(option);
            }
        });

        function changeLanguage() {
            s_name.innerHTML = '';
            voices.forEach(function (voice) {
                if (s_lang.value === voice.lang) {
                    let option = document.createElement('option');
                    option.value = voice.name;
                    option.innerHTML = voice.name;
                    s_name.appendChild(option);
                }
            });
        }

        s_lang.addEventListener('change', changeLanguage);
        s_name.addEventListener('change', function () {
           voices.forEach(function (v) {
               if (s_name.value === v.name) {
                   voice = v;
               }
           })
        });
        changeLanguage();

        document.getElementById('speak').addEventListener('click', function () {
            var text = new SpeechSynthesisUtterance(document.getElementById('text').value);
            text.voice = voice;
            speechSynthesis.speak(text);
        })
    });
</script>
</body>
</html>
